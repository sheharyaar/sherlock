# Generated by ChatGPT
CC := gcc
SRC := test.c

CFLAGS_BASE := -O0 -fno-omit-frame-pointer
LDFLAGS_BASE :=

# Baseline (lazy PLT)
t-baseline: $(SRC)
	$(CC) $(CFLAGS_BASE) -no-pie \
		$(SRC) -o $@ $(LDFLAGS_BASE)

# Full RELRO (eager binding)
t-now: $(SRC)
	$(CC) $(CFLAGS_BASE) -no-pie \
		$(SRC) -o $@ $(LDFLAGS_BASE) -Wl,-z,now

# CET (PLT + PLT.SEC)
t-cet: $(SRC)
	$(CC) $(CFLAGS_BASE) -no-pie \
		-fcf-protection=full \
		$(SRC) -o $@ $(LDFLAGS_BASE)

# CET + eager binding
t-cet-now: $(SRC)
	$(CC) $(CFLAGS_BASE) -no-pie \
		-fcf-protection=full \
		$(SRC) -o $@ $(LDFLAGS_BASE) -Wl,-z,now

# no-PLT (GOT indirect calls)
t-noplt: $(SRC)
	$(CC) $(CFLAGS_BASE) -no-pie \
		-fno-plt \
		$(SRC) -o $@ $(LDFLAGS_BASE)

# no-PLT + eager binding
t-noplt-now: $(SRC)
	$(CC) $(CFLAGS_BASE) -no-pie \
		-fno-plt \
		$(SRC) -o $@ $(LDFLAGS_BASE) -Wl,-z,now

# PIE (ASLR + relocation)
t-pie: $(SRC)
	$(CC) $(CFLAGS_BASE) -fPIE -pie \
		$(SRC) -o $@ $(LDFLAGS_BASE)

# PIE + CET + no-PLT (worst case)
t-pie-cet-noplt: $(SRC)
	$(CC) $(CFLAGS_BASE) -fPIE -pie \
		-fcf-protection=full \
		-fno-plt \
		$(SRC) -o $@ $(LDFLAGS_BASE)

all: \
	t-baseline \
	t-now \
	t-cet \
	t-cet-now \
	t-noplt \
	t-noplt-now \
	t-pie \
	t-pie-cet-noplt

clean:
	rm -f t-*
